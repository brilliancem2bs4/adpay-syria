<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - AdPay Syria</title>
    <style>
        body { 
            font-family: 'Arial', sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f1f5f9; 
        }
        .container { 
            max-width: 1000px; 
            margin: auto; 
        }
        .header { 
            background: linear-gradient(135deg, #7C3AED, #8B5CF6); 
            color: white; 
            padding: 30px; 
            border-radius: 20px; 
            margin-bottom: 30px;
            text-align: center;
        }
        h1 { margin: 0 0 15px 0; font-size: 32px; }
        .password-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px auto;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .password-box input {
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 10px;
            width: 80%;
            margin: 15px 0;
            font-size: 18px;
        }
        .btn { 
            background: #7C3AED; 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 10px; 
            font-size: 18px; 
            font-weight: bold; 
            cursor: pointer;
            margin: 10px;
        }
        .admin-panel {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab {
            padding: 15px 25px;
            background: #e5e7eb;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
        }
        .tab.active {
            background: #7C3AED;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .order-card {
            background: #f8fafc;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-right: 5px solid #047857;
        }
        .order-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px;
        }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-published { background: #d1fae5; color: #065f46; }
        .status-paid { background: #dbeafe; color: #1e40af; }
        .search-box {
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 10px;
            width: 100%;
            margin: 20px 0;
            font-size: 16px;
        }
        .stats-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        .stat-number {
            font-size: 42px;
            font-weight: bold;
            color: #7C3AED;
            margin: 10px 0;
        }
        .action-buttons {
            margin-top: 20px;
        }
        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            margin: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-mark-published { background: #10b981; color: white; }
        .btn-mark-paid { background: #3b82f6; color: white; }
        .btn-delete { background: #ef4444; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… AdPay Syria</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
        </div>
        
        <div class="password-box" id="loginSection">
            <h2>Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
            <p>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</p>
            <input type="password" id="adminPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <br>
            <button class="btn" onclick="checkPassword()">ğŸ”“ Ø¯Ø®ÙˆÙ„</button>
        </div>
        
        <div class="admin-panel" id="adminPanel">
            <div class="tabs">
                <button class="tab active" onclick="showTab('orders')">ğŸ“‹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
                <button class="tab" onclick="showTab('users')">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
                <button class="tab" onclick="showTab('stats')">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                <button class="tab" onclick="showTab('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            </div>
            
            <div id="orders-tab" class="tab-content active">
                <h2>ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
                <input type="text" class="search-box" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨..." onkeyup="searchOrders(this.value)">
                
                <div id="ordersList">
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</p>
                </div>
            </div>
            
            <div id="users-tab" class="tab-content">
                <h2>ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                <div id="usersList">
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...</p>
                </div>
            </div>
            
            <div id="stats-tab" class="tab-content">
                <h2>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                <div class="stats-box">
                    <div class="stat-card">
                        <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                        <div class="stat-number" id="totalOrders">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>
                        <div class="stat-number" id="totalUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø©</h3>
                        <div class="stat-number" id="publishedAds">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
                        <div class="stat-number" id="totalRevenue">0 Ù„.Ø³</div>
                    </div>
                </div>
            </div>
            
            <div id="settings-tab" class="tab-content">
                <h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
                <div class="order-card">
                    <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                    <p><strong>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong> <span id="currentNumber">+963 993 113 374</span></p>
                    <input type="text" id="newNumber" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯" style="width: 100%; margin: 10px 0; padding: 10px;">
                    <button class="btn" onclick="updateWhatsAppNumber()">ğŸ’¾ ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨</button>
                    
                    <h3 style="margin-top: 30px;">Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                    <button class="btn" onclick="exportData()">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <button class="btn" onclick="importData()" style="background: #10b981;">ğŸ“¤ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <input type="file" id="importFile" style="display: none;" accept=".json">
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Password for admin access
        const ADMIN_PASSWORD = "salmia123"; // Change this to your own password
        
        function checkPassword() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadAllData();
            } else {
                alert('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }
        
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Activate selected button
            event.target.classList.add('active');
            
            // Refresh data if needed
            if (tabName === 'orders') loadOrders();
            if (tabName === 'users') loadUsers();
            if (tabName === 'stats') loadStats();
        }
        
        function loadAllData() {
            loadOrders();
            loadUsers();
            loadStats();
        }
        
        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('adpay_orders') || '[]');
            let html = '';
            
            if (orders.length === 0) {
                html = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯.</p>';
            } else {
                // Sort by newest first
                orders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                orders.forEach(order => {
                    html += `
                        <div class="order-card">
                            <h4>ğŸ“± ${order.phone} | ğŸ“… ${order.timestamp}</h4>
                            <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</strong> ${order.id}</p>
                            <p><strong>Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:</strong> ${order.adText || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</p>
                            <p><strong>Ø§Ù„Ø¨Ø§Ù‚Ø©:</strong> ${order.packageName || 'Ø¥Ø¹Ù„Ø§Ù† ÙˆØ§Ø­Ø¯'}</p>
                            <p><strong>Ø§Ù„ÙƒÙˆØ¯:</strong> ${order.userCode || 'Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯'}</p>
                            <span class="order-status status-pending">â³ Ù…Ø¹Ù„Ù‚</span>
                            <span class="order-status status-paid">ğŸ’µ Ù…Ø¯ÙÙˆØ¹</span>
                            <span class="order-status status-published">âœ… Ù…Ù†Ø´ÙˆØ±</span>
                            <div class="action-buttons">
                                <button class="action-btn btn-mark-published" onclick="updateOrderStatus('${order.id}', 'published')">âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø±</button>
                                <button class="action-btn btn-mark-paid" onclick="updateOrderStatus('${order.id}', 'paid')">ğŸ’° ØªÙ… Ø§Ù„Ø¯ÙØ¹</button>
                                <button class="action-btn btn-delete" onclick="deleteOrder('${order.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('ordersList').innerHTML = html;
        }
        
        function loadUsers() {
            let users = [];
            // Get all users from localStorage
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('adpay_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    users.push(user);
                }
            }
            
            let html = '';
            
            if (users.length === 0) {
                html = '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†.</p>';
            } else {
                users.forEach(user => {
                    html += `
                        <div class="order-card">
                            <h4>ğŸ‘¤ ${user.code}</h4>
                            <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${user.created}</p>
                            <p><strong>Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„:</strong> ${user.lastLogin}</p>
                            <p><strong>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</strong> <span style="font-size: 24px; color: #7C3AED;">${user.adsRemaining}</span></p>
                            <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª:</strong> ${user.totalSpent || 0} Ù„.Ø³</p>
                            <div class="action-buttons">
                                <button class="action-btn" onclick="addAdsToUser('${user.code}', 1)" style="background: #10b981; color: white;">+1 Ø¥Ø¹Ù„Ø§Ù†</button>
                                <button class="action-btn" onclick="addAdsToUser('${user.code}', 5)" style="background: #3b82f6; color: white;">+5 Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
                                <button class="action-btn" onclick="resetUserAds('${user.code}')" style="background: #ef4444; color: white;">ğŸ”„ ØªØµÙÙŠØ±</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('usersList').innerHTML = html;
        }
        
        function loadStats() {
            // Total orders
            const orders = JSON.parse(localStorage.getItem('adpay_orders') || '[]');
            document.getElementById('totalOrders').textContent = orders.length;
            
            // Total users
            let userCount = 0;
            for (let i = 0; i < localStorage.length; i++) {
                if (localStorage.key(i).startsWith('adpay_user_')) {
                    userCount++;
                }
            }
            document.getElementById('totalUsers').textContent = userCount;
            
            // Published ads (count orders with status published)
            const publishedCount = orders.filter(o => o.status === 'published').length;
            document.getElementById('publishedAds').textContent = publishedCount;
            
            // Total revenue
            let revenue = 0;
            orders.forEach(order => {
                if (order.status === 'paid' || order.status === 'published') {
                    revenue += order.packagePrice || 0;
                }
            });
            document.getElementById('totalRevenue').textContent = revenue + ' Ù„.Ø³';
        }
        
        function searchOrders(query) {
            const orders = JSON.parse(localStorage.getItem('adpay_orders') || '[]');
            const filtered = orders.filter(order => 
                order.phone.includes(query) || 
                order.id.includes(query) ||
                (order.adText && order.adText.includes(query))
            );
            
            let html = '';
            filtered.forEach(order => {
                html += `
                    <div class="order-card">
                        <h4>ğŸ“± ${order.phone}</h4>
                        <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</strong> ${order.id}</p>
                        <p><strong>Ø§Ù„Ù†Øµ:</strong> ${order.adText}</p>
                    </div>
                `;
            });
            
            document.getElementById('ordersList').innerHTML = html || '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>';
        }
        
        function addAdsToUser(userCode, adsToAdd) {
            const userKey = 'adpay_user_' + userCode;
            const user = JSON.parse(localStorage.getItem(userKey));
            if (user) {
                user.adsRemaining += adsToAdd;
                localStorage.setItem(userKey, JSON.stringify(user));
                alert(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${adsToAdd} Ø¥Ø¹Ù„Ø§Ù† Ø¥Ù„Ù‰ ${userCode}\nØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${user.adsRemaining}`);
                loadUsers();
            }
        }
        
        function resetUserAds(userCode) {
            if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ${userCode}ØŸ`)) {
                const userKey = 'adpay_user_' + userCode;
                const user = JSON.parse(localStorage.getItem(userKey));
                if (user) {
                    user.adsRemaining = 0;
                    localStorage.setItem(userKey, JSON.stringify(user));
                    alert(`âœ… ØªÙ… ØªØµÙÙŠØ± Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ${userCode}`);
                    loadUsers();
                }
            }
        }
        
        function updateOrderStatus(orderId, status) {
            const orders = JSON.parse(localStorage.getItem('adpay_orders') || '[]');
            const orderIndex = orders.findIndex(o => o.id === orderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].status = status;
                orders[orderIndex].updated = new Date().toISOString();
                localStorage.setItem('adpay_orders', JSON.stringify(orders));
                alert(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ ${orderId} Ø¥Ù„Ù‰: ${status}`);
                loadOrders();
            }
        }
        
        function deleteOrder(orderId) {
            if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ ${orderId}ØŸ`)) {
                const orders = JSON.parse(localStorage.getItem('adpay_orders') || '[]');
                const filtered = orders.filter(o => o.id !== orderId);
                localStorage.setItem('adpay_orders', JSON.stringify(filtered));
                alert(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ ${orderId}`);
                loadOrders();
            }
        }
        
        function updateWhatsAppNumber() {
            const newNumber = document.getElementById('newNumber').value;
            if (newNumber && confirm(`ØªØºÙŠÙŠØ± Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ù† +963 993 113 374 Ø¥Ù„Ù‰ ${newNumber}ØŸ`)) {
                localStorage.setItem('whatsapp_number', newNumber);
                document.getElementById('currentNumber').textContent = newNumber;
                alert('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨');
            }
        }
        
        function exportData() {
            const allData = {};
            
            // Collect all adpay-related data
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.includes('adpay') || key.includes('ORD_')) {
                    allData[key] = JSON.parse(localStorage.getItem(key));
                }
            }
            
            // Create download link
            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'adpay-backup-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            
            alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
        
        function importData() {
            document.getElementById('importFile').click();
        }
        
        // Handle file import
        document.getElementById('importFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Confirm before importing
                    if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${Object.keys(importedData).length} Ø³Ø¬Ù„ØŸ\nÙ‡Ø°Ø§ Ù‚Ø¯ ÙŠØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©!`)) {
                        // Clear existing data first
                        for (let i = 0; i < localStorage.length; i++) {
                            const key = localStorage.key(i);
                            if (key.includes('adpay') || key.includes('ORD_')) {
                                localStorage.removeItem(key);
                            }
                        }
                        
                        // Import new data
                        for (const key in importedData) {
                            localStorage.setItem(key, JSON.stringify(importedData[key]));
                        }
                        
                        alert('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    }
                } catch (error) {
                    alert('âŒ Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­');
                }
            };
            reader.readAsText(file);
        });
    </script>
</body>
</html>
